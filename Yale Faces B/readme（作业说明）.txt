作业2
本作业将分析如何使用特征选择、聚类和分类技术来识别人脸
---
下载两个数据集（原始图像和裁剪图像）。您的任务是对这些数据集进行分析。请从裁剪图像开始，并执行以下分析：

1. 对图像进行SVD（奇异值分解）分析（每个图像重塑为列向量，每列是一个新图像）。
2. 解释U、Σ和V矩阵的含义。
3. 奇异值谱是什么样的？需要多少模式才能进行良好的图像重建？（即，面部空间的秩r是多少？）
4. 比较裁剪（且对齐）图像与未裁剪图像之间的差异。
5. 对于裁剪和未裁剪的图像，随机旋转图像，使用不同（小和大）的旋转角度。评估这两种情况下SVD的秩。旋转矩阵可以通过与以下矩阵相乘来简单构造：
### 人脸识别：
尝试构建一个分类器来识别训练集中的个体。
- （测试1）人脸分类：考虑各种人脸，看看是否可以构建一个合理识别单个面孔的分类器。
- （测试2）性别分类：您能否构建一个能够区分男性和女性的算法？
- （测试3）无监督算法：以无监督的方式，您能否开发算法自动寻找人脸中自然聚类的模式？

注意：您可以使用任何（希望是所有）讨论过的不同聚类和分类方法。在这些任务中，确保相互比较它们的效果。

---
答：
1. 运行SVD.m文件，可以得到U、Σ和V矩阵，其形状分别为2414*2414、2414*2414、32256*2414
2.
在奇异值分解（SVD）中，一个矩阵A可以被分解为三个矩阵的乘积U、S和V（V实际上是一个转置后的矩阵）
U：U是一个 m×m 的矩阵，其中 m 是输入数据的行数（特征数）。U的列是左奇异向量，这些向量表示了原始数据的主成分或特征空间，每个列向量对应于一个特征，它们彼此正交，可以用来重建原始数据。
Σ：Σ对角元素是奇异值，表示每个主成分的重要性或方差。奇异值通常按降序排列，较大的奇异值对应于数据中更重要的特征。这些奇异值可以用来判断保留多少主成分来实现数据的降维。
V：V矩阵的列可以被看作是图像空间的基，其中32256是原始图像的列数。
在上述矩阵中，U提供了关于特征的描述，S提供了特征的重要性，V提供了样本信息的描述。
3. 运行SVD.m文件可以得到奇异值谱和面部空间的秩r=1584
4.裁剪图像：yalefaces_cropped:内部包含39个子文件夹表示39个人物个体，每个子文件夹中包含64张.pgm图像，表示一个人在不同情况下拍摄的图片（_MACOX文件夹表示适用于在苹果系统上应用的数据集）。
未裁剪图像：yalefaces_uncropped: 包含165张GIF格式的图像(暂无扩展名)，涵盖15个被试对象（subject01,subject02等）。每个被试对象有11张图像分别对应以下面部表情或配置：中心光照、佩戴眼镜、快乐、左侧光照、不佩戴眼镜、正常、右侧光照、悲伤、困倦、惊讶和眨眼。
可以看出，裁剪图像和未裁剪图像的数据文件无论从被试个体和格式上都不相同。
5.原始未裁剪的图片没有.gif扩展名，在解决问题5之前运行addgifname.m文件为未裁剪的图片添加.gif扩展名。然后运行randomrotate.m文件，可以得到输出如下：
裁剪图像小角度旋转的秩: 2414
裁剪图像大角度旋转的秩: 2414
未裁剪图像小角度旋转的秩: 165
未裁剪图像大角度旋转的秩: 165
###人脸识别###
1.测试1：构建合理识别单个面孔的分类器：
首先，文件夹中的数据集按照个体的不同分为不同的子文件，使用的算法为ResNet，分类器文件为faceclassification.m。
2.测试2：构建区分男女性别算法的分类器：
为了对数据集添加男女性别的标签，我们将裁剪图像的数据集yalefaces_cropped分为男性和女性两个文件夹，通过查看可以发现，女性被试对象的数据集包括：
YaleB05,15,22,24,27,28,32,34和37。按照性别分类的文件被我们存储在名为genderCroppedYale的文件夹中。
分类器文件为genderclassification.m，使用的算法为SVM。运行后得到结果为：男性样本数量：1839，女性样本数量：575，分类器准确率：98.55%。
3.测试3：开发无监督的人脸自然聚类：
分类器文件为unsupervisionclassification.m，设置了五种聚类结果，使用的算法为k-means聚类算法。



